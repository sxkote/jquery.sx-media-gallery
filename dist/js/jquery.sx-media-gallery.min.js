"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&null!==module&&module.exports?module.exports=e:e(jQuery)}(function(e,t){function i(e){function t(e){n?(i(),Q(t),s=!0,n=!1):s=!1}var i=e,n=!1,s=!1;this.kick=function(e){n=!0,s||t()},this.end=function(e){var t=i;e&&(s?(i=n?function(){t(),e()}:e,n=!0):e())}}function n(){return!0}function s(){return!1}function a(e){e.preventDefault()}function o(e){L[e.target.tagName.toLowerCase()]||e.preventDefault()}function l(e){return 1===e.which&&!e.ctrlKey&&!e.altKey}function r(e,t){var i,n;if(e.identifiedTouch)return e.identifiedTouch(t);for(i=-1,n=e.length;++i<n;)if(e[i].identifier===t)return e[i]}function h(e,t){var i=r(e.changedTouches,t.identifier);if(i&&(i.pageX!==t.pageX||i.pageY!==t.pageY))return i}function u(e){var t;l(e)&&(t={target:e.target,startX:e.pageX,startY:e.pageY,timeStamp:e.timeStamp},T(document,J.move,c,t),T(document,J.cancel,d,t))}function c(e){var t=e.data;A(e,t,e,m)}function d(e){m()}function m(){M(document,J.move,c),M(document,J.cancel,d)}function f(e){var t,i;L[e.target.tagName.toLowerCase()]||(t=e.changedTouches[0],i={target:t.target,startX:t.pageX,startY:t.pageY,timeStamp:e.timeStamp,identifier:t.identifier},T(document,P.move+"."+t.identifier,p,i),T(document,P.cancel+"."+t.identifier,g,i))}function p(e){var t=e.data,i=h(e,t);i&&A(e,t,i,v)}function g(e){var t=e.data,i=r(e.changedTouches,t.identifier);i&&v(t.identifier)}function v(e){M(document,"."+e,p),M(document,"."+e,g)}function A(e,t,i,n){var s=i.pageX-t.startX,a=i.pageY-t.startY;s*s+a*a<O*O||w(e,t,i,s,a,n)}function y(){return this._handled=n,!1}function _(e){e._handled()}function w(e,t,i,n,s,a){var o,l;t.target;o=e.targetTouches,l=e.timeStamp-t.timeStamp,t.type="movestart",t.distX=n,t.distY=s,t.deltaX=n,t.deltaY=s,t.pageX=i.pageX,t.pageY=i.pageY,t.velocityX=n/l,t.velocityY=s/l,t.targetTouches=o,t.finger=o?o.length:1,t._handled=y,t._preventTouchmoveDefault=function(){e.preventDefault()},R(t.target,t),a(t.identifier)}function k(e){var t=e.data.timer;e.data.touch=e,e.data.timeStamp=e.timeStamp,t.kick()}function b(e){var t=e.data.event,i=e.data.timer;C(),X(t,i,function(){setTimeout(function(){M(t.target,"click",s)},0)})}function C(e){M(document,J.move,k),M(document,J.end,b)}function Y(e){var t=e.data.event,i=e.data.timer,n=h(e,t);n&&(e.preventDefault(),t.targetTouches=e.targetTouches,e.data.touch=n,e.data.timeStamp=e.timeStamp,i.kick())}function B(e){var t=e.data.event,i=e.data.timer,n=r(e.changedTouches,t.identifier);n&&(x(t),X(t,i))}function x(e){M(document,"."+e.identifier,Y),M(document,"."+e.identifier,B)}function E(e,t,i,n){var s=i-e.timeStamp;e.type="move",e.distX=t.pageX-e.startX,e.distY=t.pageY-e.startY,e.deltaX=t.pageX-e.pageX,e.deltaY=t.pageY-e.pageY,e.velocityX=.3*e.velocityX+.7*e.deltaX/s,e.velocityY=.3*e.velocityY+.7*e.deltaY/s,e.pageX=t.pageX,e.pageY=t.pageY}function X(e,t,i){t.end(function(){return e.type="moveend",R(e.target,e),i&&i()})}function V(e,t,i){return T(this,"movestart.move",_),!0}function D(e){return M(this,"dragstart drag",a),M(this,"mousedown touchstart",o),M(this,"movestart",_),!0}function S(e){"move"!==e.namespace&&"moveend"!==e.namespace&&(T(this,"dragstart."+e.guid+" drag."+e.guid,a,t,e.selector),T(this,"mousedown."+e.guid,o,t,e.selector))}function I(e){"move"!==e.namespace&&"moveend"!==e.namespace&&(M(this,"dragstart."+e.guid+" drag."+e.guid),M(this,"mousedown."+e.guid))}var O=6,T=e.event.add,M=e.event.remove,R=function(t,i,n){e.event.trigger(i,n,t)},Q=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout(function(){e()},25)}}(),L={textarea:!0,input:!0,select:!0,button:!0},J={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},P={move:"touchmove",cancel:"touchend",end:"touchend"};e.event.special.movestart={setup:V,teardown:D,add:S,remove:I,_default:function(e){function n(t){E(a,o.touch,o.timeStamp),R(e.target,a)}var a,o;e._handled()&&(a={target:e.target,startX:e.startX,startY:e.startY,pageX:e.pageX,pageY:e.pageY,distX:e.distX,distY:e.distY,deltaX:e.deltaX,deltaY:e.deltaY,velocityX:e.velocityX,velocityY:e.velocityY,timeStamp:e.timeStamp,identifier:e.identifier,targetTouches:e.targetTouches,finger:e.finger},o={event:a,timer:new i(n),touch:t,timeStamp:t},e.identifier===t?(T(e.target,"click",s),T(document,J.move,k,o),T(document,J.end,b,o)):(e._preventTouchmoveDefault(),T(document,P.move+"."+e.identifier,Y,o),T(document,P.end+"."+e.identifier,B,o)))}},e.event.special.move={setup:function(){T(this,"movestart.move",e.noop)},teardown:function(){M(this,"movestart.move",e.noop)}},e.event.special.moveend={setup:function(){T(this,"movestart.moveend",e.noop)},teardown:function(){M(this,"movestart.moveend",e.noop)}},T(document,"mousedown.move",u),T(document,"touchstart.move",f),"function"==typeof Array.prototype.indexOf&&!function(e,t){for(var i=["changedTouches","targetTouches"],n=i.length;n--;)e.event.props.indexOf(i[n])===-1&&e.event.props.push(i[n])}(e)}),function(e){"function"==typeof define&&define.amd?define(["jquery",void 0,"jquery.event.move"],e):"undefined"!=typeof module&&null!==module&&module.exports?module.exports=e:e(jQuery)}(function(e,t){function i(e){var t,i,n;t=e.currentTarget.offsetWidth,i=e.currentTarget.offsetHeight,n={distX:e.distX,distY:e.distY,velocityX:e.velocityX,velocityY:e.velocityY,finger:e.finger},e.distX>e.distY?e.distX>-e.distY?(e.distX/t>l.threshold||e.velocityX*e.distX/t*l.sensitivity>1)&&(n.type="swiperight",o(e.currentTarget,n)):(-e.distY/i>l.threshold||e.velocityY*e.distY/t*l.sensitivity>1)&&(n.type="swipeup",o(e.currentTarget,n)):e.distX>-e.distY?(e.distY/i>l.threshold||e.velocityY*e.distY/t*l.sensitivity>1)&&(n.type="swipedown",o(e.currentTarget,n)):(-e.distX/t>l.threshold||e.velocityX*e.distX/t*l.sensitivity>1)&&(n.type="swipeleft",o(e.currentTarget,n))}function n(t){var i=e.data(t,"event_swipe");return i||(i={count:0},e.data(t,"event_swipe",i)),i}var s=e.event.add,a=e.event.remove,o=function(t,i,n){e.event.trigger(i,n,t)},l={threshold:.4,sensitivity:6};e.event.special.swipe=e.event.special.swipeleft=e.event.special.swiperight=e.event.special.swipeup=e.event.special.swipedown={setup:function(e,t,a){var e=n(this);if(!(e.count++>0))return s(this,"moveend",i),!0},teardown:function(){var e=n(this);if(!(--e.count>0))return a(this,"moveend",i),!0},settings:l}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();!function(e,t,i,n){var s="sxMediaGallery",a="sxmg",o={File:"file",Image:"image",Video:"video",Audio:"audio",PDF:"pdf",Excel:"excel",Word:"word",PowerPoint:"powerpoint",Text:"text",ZIP:"zip"},l={Close:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABYElEQVRYR7WX7RHCIAyG46Y6gTqJOoGu6AR6L3fhUkrIB5Rfnm3zPAUS0hPtx5mI3kT0JKJ753rmrwcRIS7ifWSAUxON4fw3br5kiOIZvAzi8kC8KiEFWvgKiRa+k2ABDT4jocE3EhCw4BkJC14lIPALrLFnT3jhBRuZAc9MhODY4N490E5SbybCcGSDJwu0FZISKTgvgQR4N6RcDvyWeW5tKbUO8INRCQsor2/gvRk4UmIHHwnwtGJtV4wu3BJYJaHCPQKzEkO4VyArgaMXR/pwtMexdnM0zxHHU7ZLKbZGBi7rxLCfsARm4C6JkcAKuCmhCayEDyV6AkfAVYlWIArnDRapmJvskAIZOHe30QOsSrDADDx7gBUJCKBaXa1iIK6Pymt0Jl7RptSs7YEuG+/0jTSlHnh0OdxNaQTulSgxPU1pBm5J1JjWx+kMXJNwNaXIjFv7KR3IlPZWZEc35h/4CGLAjclibQAAAABJRU5ErkJggg==",Menu:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARUlEQVRYR+3U0QkAIAgFQN1/6IL6aQIVOhd4cujLaJ5szg8LEHgFVvFBnmwLEBglUPwEN25UEekBAgT0gBsgQEAP/CmwAdmEEiEL49BKAAAAAElFTkSuQmCC",Download:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABqklEQVRYR+2X7U3DMBCG327ACDABMAEwATABMAGMABNAJ4BOQDcAJqBswAbQCUBPdFeFJK4/4qp/OKlKFdn3Pr4725eJtmyTLevrH6BWBC4knUk6lrQj6VvSq6SpPYOZTgXA+amkXUmfku7seSDpURLPkAFyblC9MSkACFx2ZrLCW/ux4pgtJJ0MQcQAEAaghs0tEn98xQAI31ENdfNxKIlorCwG8GVFVYuBorwJAZDLa8s3xbYJe7Od0osAVfxsVb4JYfdJ8T7Y9uR/cxKy8pfIVqoNhTi7YgEAObmvrZDgD4g9AN4LV98t4J8E0e6QKU5KJnr62g5L/DQpKJlYC6ApQg6G/YLw1UjBEielx20NgJk7KYnCWIAlxe9OOAs499el4knSVWKqYlFFnDHz7ip4ybkQAkmBWCeOMLciVzl9RXJPiDBdD7YOoi0+G+gjegGM3YbtCTGIbPGcCDhICKJIvATAU9BOB1esd01JYQ/1A4kFvqoDh/B52eKlEWBed9t+WKPR3PE5llOEXb8OwXu+B7LFx0TAYbwlLxKvAZAT7cGxY1IwWhwHv/0QUz8k+/1lAAAAAElFTkSuQmCC",Profile:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABIklEQVRYR+2XYQ3CMBSEbwrAAeAAJyABB+AAcAAOkIAUJIADHEBudMvWjLzjNR1Zsv4hjJf3vh3XS1vgs04AVgDm4XuujzuAC4BjNaAIw7e5Jn7pS4ADfyPAE8CkZwAqsagAXj0Pb6pfKhAD8FmO1TlnUABTAHsA6yBPy82CZMkKcKvGu+UMYCcMZ0kyQNduqd0sQGQBePwQXskADA56oLnqQOlDgSqymyYs00xcbgWWkfvjedeQ7TcDxA1Ao82M5ooZ3QBqVFsJOlwA0WNmmVsBs7NY4AZQPRBzxJ4YLoCosFnmVsDsLBa4AUYPiAqbZe6/wOwsFowAsgKiosllZVL+62pWnyUJ0HXWS349o0HrcspaQmyEk08qGN+cF5r6LPkGr15XIUxe5/QAAAAASUVORK5CYII=",ArrowLeft:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAu0lEQVRYR82XYQ6AIAhG8abdrI7abHMzBoIyP+x38B4sCQslPyXIv4joieSICFT4TUSRHMvBDV6Lhwv0cLgAh0MFJDhMQINDBEbw7QIWfKuABx6ZQV+sdoYhcE0ABpcEoHAuAIf3AinwowSqTEoX+DGES0hzACpx5CBq4xXSCWud8khYOYb/C0+wJeHJoUp4g1MXEuub8BYhdmE2OHUp1ToxW8SvE6vBqRcT3onVIoYrmXfXS72ceiWH772wrR4VW0r/CgAAAABJRU5ErkJggg==",ArrowRight:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAq0lEQVRYR8XXAQqAIAyF4XnTulmdtFiQIGZuc2/zAP4fgg4LJa/i0D+IaLPu4wG4iIgRuwXhBeC2CeEJMCG8AWoEAqBCoABiBBIgQqABUwQD+B6j1/CKRgGGJxEJ+EREAzpEBqBBZAEqIhNw8hjPAjxxPoYMQI1nAJp4NKCLRwI+4y9gdQ7MZskwHgH4jaMB0zgSIIqjAOI4AqCKewPUcU+AKe4FSP+cLj1kN48NOiE+oolLAAAAAElFTkSuQmCC"},r=function(e,t){var i;for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},h=function(){function e(t){_classCallCheck(this,e),this.id="",this.url="",this.thumbnail="",this.type="",this.title="",this.comment="",this.date=null,t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&r(this,t),this.date&&(this.date=new Date(this.date)),null!=this.type&&this.type!=n&&""!=this.type||(this.type=e.defineFileType(this.url)),this.type!=o.Image||this.thumbnail&&""!=this.thumbnail||(this.thumbnail=this.url)}return _createClass(e,[{key:"toString",value:function(){return this.url}},{key:"hasInfoToDisplay",get:function(){return this.dateString||this.title||this.comment}},{key:"dateString",get:function(){if(null==this.date||this.date==n||!(this.date instanceof Date))return"";var e=this.date.getFullYear(),t=this.date.getMonth()+1;t<10&&(t="0"+t.toString());var i=this.date.getDate();return i+"."+t+"."+e}}],[{key:"defineFileType",value:function(e){if(!e||"string"!=typeof e||""==e)return o.File;var t=e.substring(e.lastIndexOf(".")+1);switch(t){case"jpeg":case"jpg":case"bmp":case"png":case"gif":case"tiff":return o.Image;case"avi":case"mpeg":case"mp4":case"wmv":case"mov":return o.Video;case"mp3":case"wav":case"wma":return o.Audio;case"pdf":return o.PDF;case"doc":case"docx":case"dotx":return o.Word;case"xls":case"xlsx":return o.Excel;case"ppt":case"pptx":return o.PowerPoint;case"txt":return o.Text;case"zip":case"7z":case"rar":return o.ZIP;default:return o.File}}}]),e}(),u=function(){function s(t){_classCallCheck(this,s),this._defaults={width:1,height:1,infoVisible:!0},this._options=r(this._defaults,t),this._prefix=a+"-viewer",this._element=e("<div class='"+this._prefix+" unselectable'></div>"),this._info=new c({visible:this._options.infoVisible}),this.element.append(this.info.element)}return _createClass(s,[{key:"displayMaterial",value:function(t){var i=this._prefix;if(null==this.element)throw new Error("GalleryView DOM element is destroyed!");t!=n&&(this.material=t),this.clear(),null!=this.material&&(this.material.type.toLowerCase()==o.Image.toLowerCase()?(this._content=e("<img src="+this.material.url+" class='"+i+"-content "+i+"-content-image'>"),this._content.css("visibility","hidden"),this._content.load(function(e){this._contentOriginalWidth=e.target.width,this._contentOriginalHeight=e.target.height,this.resize(),this._content.css("visibility","visible")}.bind(this))):(this._contentOriginalWidth=640,this._contentOriginalHeight=480,this.material.type.toLowerCase()==o.Video.toLowerCase()?this._content=e("<video class='"+i+"-content "+i+'-content-video\' controls="controls"><source src="'+this.material.url+'"></video>'):this.material.type.toLowerCase()==o.PDF.toLowerCase()?this._content=e("<div class='"+i+"-content'></div>"):this._content=e("<div class='"+i+"-content'><h2>No data to display</h2></div>")),this.content&&(this.element.append(this.content),this.resize(),this.material.type.toLowerCase()==o.PDF.toLowerCase()&&PDFObject.embed(this.material.url,this._content)),null!=this.info&&this.info.displayMaterial(t))}},{key:"clear",value:function(){null!=this.content&&this.content.remove(),this._content=null,this._contentOriginalWidth=0,this._contentOriginalHeight=0,null!=this.info&&this.info.displayMaterial(null)}},{key:"resize",value:function(e,t,i){if(e==n&&(e=this._options.width),t==n&&(t=this._options.height),i==n&&(i=this._options.margins),this._options.width=e,this._options.height=t,this._options.margins=i,null!=this.element&&null!=this.material&&!(null==this.content||this._contentOriginalWidth<=0||this._contentOriginalHeight<=0)){var s=this._options.margins?this._options.margins.top||0:0,a=this._options.margins?this._options.margins.bottom||0:0;null!=this.info&&this.info.isVisible&&(a+=this.info.element.innerHeight()),this.material.type.toLowerCase()==o.Image.toLowerCase()&&(s=0,a=0);var l=Math.min(e/this._contentOriginalWidth,(t-s-a)/this._contentOriginalHeight),r={width:this._contentOriginalWidth*l,height:this._contentOriginalHeight*l,"margin-top":s+"px","margin-bottom":a+"px"};this._content.css(r)}}},{key:"download",value:function(){if(null!=this.material&&null!=this.element){var e=this.element[0],n=this.material.url,s=this.material.filename||n.substring(n.lastIndexOf("/")+1).split("?")[0],a=new XMLHttpRequest;a.responseType="blob",a.onload=function(){var n=i.createElement("a");n.href=t.URL.createObjectURL(a.response),n.download=s,n.style.display="none",e.appendChild(n),n.click(),e.removeChild(n)},a.open("GET",n,!0),a.send()}}},{key:"element",get:function(){return this._element==n?null:this._element}},{key:"info",get:function(){return this._info==n?null:this._info}},{key:"content",get:function(){return this._content==n?null:this._content}},{key:"material",get:function(){return this._material==n?null:this._material},set:function(e){if(this.clear(),null==e||e==n)this._material=null;else if(e instanceof h)this._material=e;else{if("object"!=("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("Invalid Material object specified!");this._material=new h(e)}}}],[{key:"create",value:function(e,t,i,a,o){var l=new s({width:e,height:t,margins:i});return o!=n&&l.displayMaterial(o),l}}]),s}(),c=function(){function t(i){_classCallCheck(this,t),this._defaults={visible:!0},this._options=r(this._defaults,i),this._prefix=a+"-viewer-info",this._element=e("<div class='"+this._prefix+"'></div>"),this._date=e("<span class='"+this._prefix+"-date'></span>"),this._title=e("<span class='"+this._prefix+"-title'></span>"),this._header=e("<h1 class='"+this._prefix+"-header'></h1>"),this._header.append(this._date),this._header.append(this._title),this._element.append(this._header),this._comment=e("<div class='"+this._prefix+"-comment'></div>"),this._element.append(this._comment),this.display(this._options.visible)}return _createClass(t,[{key:"display",value:function(e){if(null==this.element)throw new Error("Viewer Info DOM element was destroyed!");e==n||e?(this._isVisible=!0,this.element.show()):(this._isVisible=!1,this.element.hide()),this.element.trigger(a+"-InfoDisplayChanged",{visible:this.isVisible})}},{key:"show",value:function(){this.display(!0)}},{key:"hide",value:function(){this.display(!1)}},{key:"toggle",value:function(){this.display(!this.isVisible)}},{key:"displayMaterial",value:function(e){this._date.text(e?e.dateString+" ":""),this._title.text(e?e.title||"":""),this._comment.text(e?e.comment||"":"")}},{key:"element",get:function(){return this._element==n?null:this._element}},{key:"isVisible",get:function(){return this._isVisible}}]),t}(),d=function(){function t(i){_classCallCheck(this,t),this._defaults={type:"button",name:"name",src:"",handler:null},this._options=r(this._defaults,i),this._prefix=a+"-"+this.type,this._element=e("<a class='"+this._prefix+" "+this._prefix+"-"+this.name+" unselectable'><img "+(this._options.src?"src='"+this._options.src+"'":"")+"></a>"),null!=this.handler&&this.element.click(this.handler)}return _createClass(t,[{key:"changeState",value:function(e){null!=this.element&&(e?this.element.addClass("active"):this.element.removeClass("active"))}},{key:"element",get:function(){return this._element==n?null:this._element}},{key:"type",get:function(){return this._options.type}},{key:"name",get:function(){return this._options.name}},{key:"handler",get:function(){return this._options.handler==n?null:this._options.handler}}],[{key:"create",value:function(e,i,n,s){return new t({type:e,name:i,src:n,handler:s})}}]),t}(),m=function(){function t(i){_classCallCheck(this,t),this._defaults={},this._options=r(this._defaults,i),this._prefix=a+"-menu",this._element=e("<div class='"+this._prefix+"'></div>"),this._buttons=[]}return _createClass(t,[{key:"addButton",value:function(e){if(e==n||null==e||!(e instanceof d))throw new Error("Wrong Button specified!");if(null==this.element)throw new Error("Menu DOM element was destroyed!");if(null==e.element)throw new Error("Button DOM element was destroyed!");this.buttons.push(e),this.element.append(e.element)}},{key:"findButton",value:function(e){if(null!=this.buttons)for(var t=0;t<this.buttons.length;t++)if(this.buttons[t].name.toLowerCase()==e.toLowerCase())return this.buttons[t];return null}},{key:"changeButtonState",value:function(e,t){var i=this.findButton(e);null!=i&&i.changeState(t)}},{key:"element",get:function(){return this._element==n?null:this._element}},{key:"buttons",get:function(){return this._buttons!=n&&null!=this._buttons&&this._buttons instanceof Array||(this._buttons=[]),this._buttons}}]),t}(),f=function(){function t(i){_classCallCheck(this,t),this._defaults={},this._options=r(this._defaults,i),this._prefix=a+"-desk",this._element=e("<div class='"+this._prefix+"'></div>").css("display","none"),this._isVisible=!1,this._materials=[]}return _createClass(t,[{key:"display",value:function(e){e==n||e?(this._isVisible=!0,this.element.show()):(this._isVisible=!1,this.element.hide()),this.element.trigger(a+"-DeskDisplayChanged",{visible:this.isVisible})}},{key:"show",value:function(){this.display(!0)}},{key:"hide",value:function(){this.display(!1)}},{key:"toggle",value:function(){this.display(!this.isVisible)}},{key:"addMaterial",value:function(t,i){if(!(t&&t instanceof h))throw new Error("Wrong Material specified!");if(null==this.element)throw new Error("Desk DOM element was destroyed!");this.materials.push(t);var n=e("<div class='"+this._prefix+"-item'></div>");t.thumbnail&&n.append(e("<img class='"+this._prefix+"-item-avatar' src='"+t.thumbnail+"'>")),i&&n.click(i),this.element.append(n)}},{key:"element",get:function(){return this._element==n?null:this._element}},{key:"isVisible",get:function(){return this._isVisible!=n&&null!=this._isVisible&&this._isVisible}},{key:"materials",get:function(){return this._materials&&this._materials instanceof Array||(this._materials=[]),this._materials}}]),t}(),p=function(){function t(i){_classCallCheck(this,t),jQuery.event.special.swipe.settings.threshold=.2,this._defaults={infoVisible:!0,allowDuplicates:!1},this._options=r(this._defaults,i),this._prefix=a+"-panel",this._isVisible=!1,this._materials=[],this._element=e("<div class='"+this._prefix+"'></div>").css("display","none"),this.element.click(function(e){e.stopPropagation()}),this.element.on("swiperight",this.movePrevious.bind(this)),this.element.on("swipeleft",this.moveNext.bind(this)),this.element.on(a+"-InfoDisplayChanged",function(e,t){this.menu.changeButtonState("info",t.visible)}.bind(this)),this.element.on(a+"-DeskDisplayChanged",function(e,t){this.menu.changeButtonState("desk",t.visible)}.bind(this)),this.element.append(d.create("panel-arrow","left",l.ArrowLeft,this.movePrevious.bind(this)).element),this.element.append(d.create("panel-arrow","right",l.ArrowRight,this.moveNext.bind(this)).element),this._viewer=u.create(this.element.width(),this.element.height(),this.margins,this._options),this.element.append(this.viewer.element),this._desk=new f,this.element.append(this.desk.element),this._menu=new m,this.menu.addButton(d.create("menu-button","desk",l.Menu,this.desk.toggle.bind(this.desk))),this.menu.addButton(d.create("menu-button","info",l.Profile,this.viewer.info.toggle.bind(this.viewer.info))),this.menu.addButton(d.create("menu-button","download",l.Download,this.viewer.download.bind(this.viewer))),this.menu.addButton(d.create("menu-button","close",l.Close,this.close.bind(this))),this.element.append(this.menu.element),this.menu.changeButtonState("info",this.viewer.info.isVisible)}return _createClass(t,[{key:"display",value:function(e){e==n||e?(this._isVisible=!0,this.element.show(),this.resize()):(this._isVisible=!1,this.element.hide())}},{key:"hide",value:function(){this.display(!1)}},{key:"show",value:function(e){e!=n&&this.displayMaterial(e),this.display(!0)}},{key:"close",value:function(){null!=this.desk&&this.desk.isVisible?this.desk.hide():(null!=this.viewer&&this.viewer.clear(),this.hide())}},{key:"addMaterial",value:function(e){if(null!=e&&e!=n)if(e instanceof h)(this.allowDuplicates||null==this.findMaterial(e.id))&&(this.materials.push(e),this.desk.addMaterial(e,function(){this.displayMaterial(e),this.desk.hide()}.bind(this)));else if(e instanceof Array)for(var t=0;t<e.length;t++)this.addMaterial(e[t]);else"object"==("undefined"==typeof e?"undefined":_typeof(e))&&this.addMaterial(new h(e))}},{key:"findMaterial",value:function(e){if(null==e||e==n)return null;for(var t=0;t<this.count;t++)if(this.materials[t].id==e)return this.materials[t];return null}},{key:"moveTo",value:function(e){var t=this.count;t<=0||(e>=t&&(e=t-1),e<0&&(e=0),this.displayMaterial(this.materials[e]))}},{key:"moveNext",value:function(){this.moveTo(this.index+1)}},{key:"movePrevious",value:function(){this.moveTo(this.index-1)}},{key:"resize",value:function(){null!=this.element&&null!=this.viewer&&this.viewer.resize(this.element.width(),this.element.height(),this.margins)}},{key:"displayMaterial",value:function(e){var t=null;t=null==e||e==n?null:e instanceof h?e:"object"==("undefined"==typeof e?"undefined":_typeof(e))?new h(e):this.findMaterial(e),null!=this.viewer&&this.viewer.displayMaterial(t)}},{key:"element",get:function(){return this._element==n?null:this._element}},{key:"isVisible",get:function(){return this._isVisible!=n&&null!=this._isVisible&&this._isVisible}},{key:"allowDuplicates",get:function(){return!!this._options.allowDuplicates}},{key:"menu",get:function(){return this._menu==n?null:this._menu}},{key:"viewer",get:function(){return this._viewer==n?null:this._viewer}},{key:"desk",get:function(){return this._desk==n?null:this._desk}},{key:"materials",get:function(){return this._materials!=n&&null!=this._materials&&this._materials instanceof Array||(this._materials=[]),this._materials}},{key:"count",get:function(){return this.materials.length}},{key:"material",get:function(){return null==this.viewer?null:this.viewer.material}},{key:"index",get:function(){return null==this.materials||null==this.material?-1:this.materials.indexOf(this.material)}},{key:"margins",get:function(){var e=this.menu&&this.menu.element?this.menu.element.innerHeight():0;return{top:e,right:0,bottom:0,left:0}}}]),t}(),g=function(){function s(n,o){_classCallCheck(this,s),this._defaults={infoVisible:!0,allowDuplicates:!1},this._options=e.extend({},this._defaults,o),this._prefix=a,this._element=e(n),this._panel=new p(this._options),e("body").append(this.panel.element),e(t).load(this.panel.resize.bind(this.panel)),e(i).click(this.panel.close.bind(this.panel)),e(t).resize(this.panel.resize.bind(this.panel)),e(n).on("click","."+this._prefix+"-item",function(t){this.panel.show(e(t.target).data("id")),t.stopPropagation()}.bind(this)),this.reload(this._options.items)}return _createClass(s,[{key:"reload",value:function(t){null!=this.panel&&(t==n?this.element.find("."+this._prefix+"-item").each(function(t,i){var n=e(i).data("id"),s=e(i).data("type"),a=e(i).data("url"),o=e(i).data("thumbnail"),l=e(i).data("date"),r=e(i).data("title"),u=e(i).data("comment");this.panel.addMaterial(new h({id:n,type:s,url:a,thumbnail:o,date:l,title:r,comment:u}))}.bind(this)):this.panel.addMaterial(t))}},{key:"element",get:function(){return this._element==n?null:this._element}},{key:"panel",get:function(){return this._panel==n?null:this._panel}}]),s}();e.fn[s]=function(t){return this.each(function(){e.data(this,"plugin_"+s)||e.data(this,"plugin_"+s,new g(this,t))})}}(jQuery,window,document);
//# sourceMappingURL=jquery.sx-media-gallery.min.js.map
